import{Ac as c,Dc as _,T as a,Tb as n,Y as o,a as b,b as p,bd as k,c as u,d as l,ka as i,r as f,tc as h,uc as g,wc as v,xc as M,yc as y,zc as D}from"./chunk-ZS4IW2D6.js";var m=class t{firestore=o(g);membersCollection=y(this.firestore,"members");membersSignal=i([]);members=this.membersSignal.asReadonly();constructor(){v(this.membersCollection,{idField:"id"}).pipe(f(r=>r.map(s=>p(b({},s),{birthday:this.convertToDate(s.birthday),expiration:this.convertToDate(s.expiration)})))).subscribe(r=>{this.membersSignal.set(r)})}convertToDate(e){if(e)return e instanceof h?e.toDate():typeof e=="string"||typeof e=="number"?new Date(e):e}getMember(e){return n(()=>this.members().find(r=>r.id===e))}addMember(e){return M(this.membersCollection,e)}updateMember(e){let r=c(this.firestore,`members/${e.id}`),d=e,{id:s}=d,I=u(d,["id"]);return _(r,I)}deleteMember(e){let r=c(this.firestore,`members/${e}`);return D(r)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};var C=class t{memberService=o(m);snackBar=o(k);members=this.memberService.members;_selectedMemberId=i(null);selectedMember=n(()=>{let e=this._selectedMemberId();return e?this.members().find(r=>r.id===e)??null:null});_loading=i(!1);loading=this._loading.asReadonly();_error=i(null);error=this._error.asReadonly();selectMember(e){this._selectedMemberId.set(e)}clearSelectedMember(){this._selectedMemberId.set(null)}addMember(e){return l(this,null,function*(){this._loading.set(!0);try{yield this.memberService.addMember(e),this.snackBar.open("Member added successfully!","Close",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"right",panelClass:["app-snackbar"]})}catch(r){this._error.set(r),this.snackBar.open("Failed to add member.","Close",{duration:3e3,panelClass:["error-snackbar"],verticalPosition:"bottom",horizontalPosition:"right"})}finally{this._loading.set(!1)}})}updateMember(e){return l(this,null,function*(){this._loading.set(!0);try{yield this.memberService.updateMember(e),this.snackBar.open("Member updated successfully!","Close",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"right",panelClass:["app-snackbar"]})}catch(r){this._error.set(r),this.snackBar.open("Failed to update member.","Close",{duration:3e3,panelClass:["error-snackbar"],verticalPosition:"bottom",horizontalPosition:"right"})}finally{this._loading.set(!1)}})}static \u0275fac=function(r){return new(r||t)};static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};export{C as a};

import{a as F}from"./chunk-NVIVYP3X.js";import{c as z,e as H,j,k as R,l as U,n as K}from"./chunk-I227JE3P.js";import{a as D}from"./chunk-2LF3AS2D.js";import{a as B}from"./chunk-TDSW6ZLC.js";import{$a as L,Ab as m,Kb as l,La as c,Lb as P,Mb as h,Nb as N,Pb as v,Qb as I,Tb as S,Y as k,a as w,b as E,bd as $,ca as u,d as y,da as C,ic as V,jc as A,ka as g,kb as s,lb as p,nb as f,ob as x,pb as M,qb as r,rb as i,wb as b,yb as _}from"./chunk-ZS4IW2D6.js";var T=(t,n)=>n.id;function q(t,n){if(t&1){let e=b();r(0,"li",10),_("click",function(){let a=u(e).$implicit,d=m(2);return C(d.selectMember(a))}),l(1),i()}if(t&2){let e=n.$implicit;c(),P(e.name)}}function G(t,n){if(t&1&&(r(0,"ul",6),f(1,q,2,1,"li",9,T),i()),t&2){let e=m();c(),x(e.filteredMembers())}}function J(t,n){if(t&1&&(r(0,"option",23),l(1),i()),t&2){let e=n.$implicit;M("value",e.number),c(),h("Locker ",e.number)}}function Q(t,n){if(t&1){let e=b();r(0,"select",22),_("ngModelChange",function(a){u(e);let d=m(3);return C(d.selectedLocker.set(a))}),f(1,J,2,2,"option",23,T),i()}if(t&2){let e=m(3);M("ngModel",e.selectedLocker()),c(),x(e.availableLockers())}}function W(t,n){if(t&1){let e=b();r(0,"div",17)(1,"label",18),l(2,"Assign Locker?"),i(),r(3,"input",19),_("change",function(a){u(e);let d=m(2);return C(d.handleLockerChange(a))}),i()(),s(4,Q,3,1,"select",20),r(5,"button",21),_("click",function(){u(e);let a=m(2);return C(a.checkIn())}),l(6,"Check-in"),i()}if(t&2){let e=m(2);c(3),M("checked",e.assignLocker()),c(),p(e.assignLocker()?4:-1)}}function X(t,n){if(t&1){let e=b();r(0,"button",24),_("click",function(){u(e);let a=m(),d=m();return C(d.checkOut(a.id))}),l(1,"Check-out"),i()}}function Y(t,n){if(t&1&&(r(0,"span"),l(1),v(2,"date"),i()),t&2){let e=m().$implicit;c(),h("Check-out: ",I(2,1,e.checkOutTime,"short"))}}function Z(t,n){if(t&1&&(r(0,"span"),l(1),i()),t&2){let e=m().$implicit;c(),h("Locker: ",e.lockerNumber)}}function ee(t,n){if(t&1&&(r(0,"li",25)(1,"span"),l(2),v(3,"date"),i(),s(4,Y,3,4,"span"),s(5,Z,2,1,"span"),i()),t&2){let e=n.$implicit;c(2),h("Check-in: ",I(3,3,e.checkInTime,"short")),c(2),p(e.checkOutTime?4:-1),c(),p(e.lockerNumber?5:-1)}}function te(t,n){if(t&1&&(r(0,"ul",16),f(1,ee,6,6,"li",25,T),i()),t&2){let e=m(2);c(),x(e.memberAttendanceHistory())}}function ne(t,n){t&1&&(r(0,"p"),l(1,"No attendance history for this member."),i())}function ie(t,n){if(t&1&&(r(0,"div",11)(1,"h2",12),l(2),i(),s(3,W,7,2)(4,X,2,0,"button",13),i(),r(5,"div",14)(6,"h3",15),l(7,"Attendance History"),i(),s(8,te,3,0,"ul",16)(9,ne,2,0,"p"),i()),t&2){let e=n,o=m();c(2),N("Selected Member: ",e.name," (",e.gender,")"),c(),p(o.isMemberCheckedIn(e.id)?4:3),c(5),p(o.memberAttendanceHistory().length>0?8:9)}}function oe(t,n){if(t&1&&(r(0,"p",29),l(1),i()),t&2){let e=m().$implicit;c(),h("Locker: ",e.lockerNumber)}}function ce(t,n){if(t&1){let e=b();r(0,"li",26)(1,"div")(2,"p",27),l(3),i(),r(4,"p",28),l(5),v(6,"date"),i(),s(7,oe,2,1,"p",29),i(),r(8,"button",30),_("click",function(){let a=u(e).$implicit,d=m(2);return C(d.checkOut(a.memberId))}),l(9,"Check-out"),i()()}if(t&2){let e=n.$implicit;c(3),P(e.memberName),c(2),h("Checked-in: ",I(6,3,e.checkInTime,"shortTime")),c(2),p(e.lockerNumber?7:-1)}}function re(t,n){if(t&1&&(r(0,"ul",8),f(1,ce,10,6,"li",26,T),i()),t&2){let e=m();c(),x(e.checkedInMembers())}}function ae(t,n){t&1&&(r(0,"p"),l(1,"No members are currently checked in."),i())}var O=class t{memberStateService=k(B);attendanceStateService=k(D);lockerStateService=k(F);snackBar=k($);searchTerm=g("");selectedMember=g(null);assignLocker=g(!1);selectedLocker=g(null);members=this.memberStateService.members;attendances=this.attendanceStateService.attendances;filteredMembers=S(()=>{let n=this.searchTerm();if(!n)return[];let e=n.toLowerCase();return this.members().filter(o=>o.name.toLowerCase().includes(e)&&!this.isMemberCheckedIn(o.id))});checkedInMembers=S(()=>this.attendances().filter(e=>!e.checkOutTime).map(e=>{let o=this.members().find(a=>a.id===e.memberId);return E(w({},e),{memberName:o?o.name:"Unknown",memberId:o?o.id:""})}));availableLockers=this.lockerStateService.availableLockers;memberAttendanceHistory=S(()=>{let n=this.selectedMember();return n?this.attendanceStateService.getAttendanceByMemberId(n.id)():[]});handleSearchInput(n){this.searchTerm.set(n.target.value)}handleLockerChange(n){this.assignLocker.set(n.target.checked)}selectMember(n){this.selectedMember.set(n),this.searchTerm.set("")}isMemberCheckedIn(n){return this.attendances().some(e=>e.memberId===n&&!e.checkOutTime)}checkIn(){return y(this,null,function*(){let n=this.selectedMember();n&&(yield this.attendanceStateService.addAttendance({memberId:n.id,checkInTime:new Date,lockerNumber:this.selectedLocker()??void 0}),this.snackBar.open(`${n.name} checked in successfully!`,"Close",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"right",panelClass:["app-snackbar"]}),this.resetSelection())})}checkOut(n){return y(this,null,function*(){let e=this.attendances().find(o=>o.memberId===n&&!o.checkOutTime);if(e){yield this.attendanceStateService.updateAttendance(e.id,{checkOutTime:new Date});let o=this.members().find(a=>a.id===n);this.snackBar.open(`${o?.name} checked out successfully!`,"Close",{duration:3e3,verticalPosition:"bottom",horizontalPosition:"right",panelClass:["app-snackbar"]}),this.resetSelection()}})}resetSelection(){this.selectedMember.set(null),this.selectedLocker.set(null),this.assignLocker.set(!1)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=L({type:t,selectors:[["app-check-in"]],decls:15,vars:4,consts:[[1,"page-container"],[1,"check-in-container"],[1,"list-header"],[1,"list-title"],[1,"search-container"],["type","text","placeholder","Search for a member...",1,"search-input",3,"input","value"],[1,"member-list"],[1,"checked-in-container"],[1,"checked-in-list"],[1,"member-list-item"],[1,"member-list-item",3,"click"],[1,"member-details"],[1,"details-title"],[1,"check-out-button"],[1,"attendance-history"],[1,"history-title"],[1,"history-list"],[1,"locker-assignment"],["for","locker"],["type","checkbox","id","locker",3,"change","checked"],[1,"locker-select",3,"ngModel"],[1,"check-in-button",3,"click"],[1,"locker-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"check-out-button",3,"click"],[1,"history-list-item"],[1,"checked-in-list-item"],[1,"member-name"],[1,"check-in-time"],[1,"locker-number"],[1,"check-out-button-small",3,"click"]],template:function(e,o){if(e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),l(4,"Member Check-in"),i()(),r(5,"div",4)(6,"input",5),_("input",function(d){return o.handleSearchInput(d)}),i()(),s(7,G,3,0,"ul",6),s(8,ie,10,4),i(),r(9,"div",7)(10,"div",2)(11,"h2",3),l(12,"Currently Checked-in"),i()(),s(13,re,3,0,"ul",8)(14,ae,2,0,"p"),i()()),e&2){let a;c(6),M("value",o.searchTerm()),c(),p(o.filteredMembers().length>0?7:-1),c(),p((a=o.selectedMember())?8:-1,a),c(5),p(o.checkedInMembers().length>0?13:14)}},dependencies:[A,K,R,U,j,z,H,V],styles:[".page-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2rem}.check-in-container[_ngcontent-%COMP%], .checked-in-container[_ngcontent-%COMP%]{background-color:#242424;padding:2rem;border-radius:8px;box-shadow:0 4px 12px #0003}.list-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.list-title[_ngcontent-%COMP%]{font-family:Bebas Neue,sans-serif;font-size:2rem;color:gold;margin:0}.search-container[_ngcontent-%COMP%]{margin-bottom:1.5rem}.search-input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #444;border-radius:4px;background-color:#333;color:#fff;font-size:1rem}.search-input[_ngcontent-%COMP%]::placeholder{color:#888}.member-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.member-list-item[_ngcontent-%COMP%]{background-color:#3a3a3a;border:1px solid #444;padding:1rem;cursor:pointer;color:#fff;transition:background-color .3s ease}.member-list-item[_ngcontent-%COMP%]:hover{background-color:#4a4a4a}.member-details[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1.5rem;background-color:#2c2c2c;border-radius:4px}.details-title[_ngcontent-%COMP%]{font-family:Bebas Neue,sans-serif;font-size:1.5rem;color:gold;margin-top:0}.locker-assignment[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1rem;color:#fff}.locker-assignment[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-right:1rem}.locker-select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #444;border-radius:4px;background-color:#333;color:#fff;font-size:1rem;margin-bottom:1rem}.check-in-button[_ngcontent-%COMP%], .check-out-button[_ngcontent-%COMP%]{background-color:gold;color:#242424;padding:.75rem 1.5rem;border:none;border-radius:4px;font-weight:700;cursor:pointer;transition:background-color .3s ease;width:100%}.check-in-button[_ngcontent-%COMP%]:hover, .check-out-button[_ngcontent-%COMP%]:hover{background-color:#e6c300}.attendance-history[_ngcontent-%COMP%]{margin-top:2rem;padding:1.5rem;background-color:#2c2c2c;border-radius:4px}.history-title[_ngcontent-%COMP%]{font-family:Bebas Neue,sans-serif;font-size:1.5rem;color:gold;margin-top:0}.history-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.history-list-item[_ngcontent-%COMP%]{background-color:#3a3a3a;border:1px solid #444;padding:1rem;margin-bottom:.5rem;color:#fff;display:flex;justify-content:space-between}.checked-in-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.checked-in-list-item[_ngcontent-%COMP%]{background-color:#3a3a3a;border:1px solid #444;padding:1rem;margin-bottom:1rem;color:#fff;display:flex;justify-content:space-between;align-items:center}.member-name[_ngcontent-%COMP%]{font-weight:700}.check-in-time[_ngcontent-%COMP%], .locker-number[_ngcontent-%COMP%]{font-size:.9rem;color:#ccc}.check-out-button-small[_ngcontent-%COMP%]{background-color:gold;color:#242424;padding:.5rem 1rem;border:none;border-radius:4px;font-weight:700;cursor:pointer;transition:background-color .3s ease}.check-out-button-small[_ngcontent-%COMP%]:hover{background-color:#e6c300}@media (max-width: 768px){.page-container[_ngcontent-%COMP%]{grid-template-columns:1fr}}"],changeDetection:0})};var Ie=[{path:"",component:O}];export{Ie as CHECK_IN_ROUTES};

import{Ac as u,Cc as O,Dc as T,Ec as S,T as r,Tb as h,Y as d,a as c,b as l,d as p,ka as b,m as o,r as A,tc as y,uc as g,wc as v,xc as k,yc as D,zc as I}from"./chunk-ZS4IW2D6.js";var s=class n{firestore=d(g);attendanceCollection=D(this.firestore,"attendance");private_todayAttendanceSignal=b([]);todayAttendance=this.private_todayAttendanceSignal.asReadonly();constructor(){let t=new Date;t.setHours(0,0,0,0);let e=y.fromDate(t),a=O(this.attendanceCollection,S("checkInTime",">=",e));v(a,{idField:"id"}).pipe(A(m=>m.map(i=>c(l(c({},i),{checkInTime:i.checkInTime.toDate()}),i.checkOutTime&&{checkOutTime:i.checkOutTime.toDate()})))).subscribe(m=>{this.private_todayAttendanceSignal.set(m)})}getAttendances(){return v(this.attendanceCollection,{idField:"id"}).pipe(A(t=>t.map(e=>c(l(c({},e),{checkInTime:e.checkInTime.toDate()}),e.checkOutTime&&{checkOutTime:e.checkOutTime.toDate()}))))}addAttendance(t){let e=k(this.attendanceCollection,t).then(a=>a.id);return o(e)}updateAttendance(t,e){let a=u(this.firestore,`attendance/${t}`),f=T(a,e);return o(f)}deleteAttendance(t){let e=u(this.firestore,`attendance/${t}`),a=I(e);return o(a)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=r({token:n,factory:n.\u0275fac,providedIn:"root"})};var j=class n{attendanceService=d(s);attendances=this.attendanceService.todayAttendance;addAttendance(t){return p(this,null,function*(){yield this.attendanceService.addAttendance(t)})}updateAttendance(t,e){return p(this,null,function*(){yield this.attendanceService.updateAttendance(t,e)})}getAttendanceByMemberId(t){return h(()=>this.attendances().filter(e=>e.memberId===t))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=r({token:n,factory:n.\u0275fac,providedIn:"root"})};export{j as a};
